cmake_minimum_required(VERSION 3.10)
project(teaser_cpp_ply)

set(CMAKE_CXX_STANDARD 14)

find_package(Eigen3 REQUIRED)
find_package(teaserpp REQUIRED)
find_package(PCL REQUIRED)
find_package(Boost REQUIRED)
find_package(OpenMP REQUIRED)

include_directories(${PCL_INCLUDE_DIRS} ${Boost_INCLUDE_DIRS} ${PROJECT_SOURCE_DIR}/GROR/include)
add_definitions(${PCL_DEFINITIONS} -D_EXPORTING -D_CRT_SECURE_NO_WARNINGS -DPCL_NO_PRECOMPILE)

# Set OpenMP flags
if(OPENMP_FOUND)
  message("OPENMP FOUND")
  set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${OpenMP_C_FLAGS}")
  set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${OpenMP_CXX_FLAGS}")
  set(CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS} ${OpenMP_EXE_LINKER_FLAGS}")
endif()

# Change this line to include your own executable file
add_executable(teaser_cpp_ply teaser_cpp_ply.cc ${PROJECT_SOURCE_DIR}/GROR/src/gror_pre.cpp ${PROJECT_SOURCE_DIR}/GROR/src/gror_common.h)
# add_executable(teaser_cpp_ply teaser_cpp_ply.cc)
# Link to teaserpp & Eigen3
target_link_libraries(teaser_cpp_ply Eigen3::Eigen teaserpp::teaser_registration teaserpp::teaser_io OpenMP::OpenMP_CXX ${PCL_LIBRARIES} ${Boost_LIBRARIES} OpenMP::OpenMP_CXX)

# Copy the data files to build directory
file(COPY ../example_data/
        DESTINATION ./example_data/
        FILES_MATCHING
        PATTERN *.ply)